#OSG V1.0 

DEF MainNode Node
{
  core DEF Writer PythonScript
  {
    field SFInt32     mSFInt32    1
    field SFDouble    mSFDouble   3.3
    field SFString    mSFString   "myString"
    field SFBool      mSFBool     true

    field SFPnt2f     mSFPnt2f     2.2 2.2
    field SFPnt3f     mSFPnt3f     3.3 3.3 3.3
    field SFPnt4f     mSFPnt4f     4.4 4.4 4.4 1

    field SFVec2f     mSFVec2f     2.2 2.2
    field SFVec2d     mSFVec2d     2.2 2.2
    field SFVec3f     mSFVec3f     3.3 3.3 3.3
    field SFVec3d     mSFVec3d     3.3 3.3 3.3
    field SFVec4f     mSFVec4f     4.4 4.4 4.4 1
    field SFVec4d     mSFVec4d     4.4 4.4 4.4 1

    field SFMatrix    mSFMatrix    1.1 2.1 3.1 4.1 5.1 6.1 7.1 8.1 9.1 10.1 11.1 12.1 13.1 14.1 15.1 16.1
    field SFMatrix4d  mSFMatrix4d  1.1 2.1 3.1 4.1 5.1 6.1 7.1 8.1 9.1 10.1 11.1 12.1 13.1 14.1 15.1 16.1

    field SFRotation  mSFRotation  1 2 3 45

    field SFColor     mSFColor     0.1 0.1 0.1
    field SFColorRGBA mSFColorRGBA 0.4 0.4 0.4 1

    #field SFPlane     mSFPlane     
    field SFVolume    mSFVolume    0 0 0 1 1 1 1

    field SFTime      mSFTime      0.1

    #field SFImage     mSFImage     ?
    #field SFNode      mSFNode      USE MainNode

    script "import time
from math import sin

if(osg.getName(self)):
    self.name = osg.getName(self)
else:
    self.name = 'unknown'

def init():
    pass	

def shutdown():
    pass

def frame(timeStamp, frameCount):

    ts = timeStamp;

    self.mSFInt32     = frameCount
    self.mSFFloat     = timeStamp
    self.mSFDouble    = timeStamp
    self.mSFString    = 'mystring ' + str(frameCount)
    if(frameCount%2 == 0):
        self.mSFBool = False
    else:
        self.mSFBool = True

    self.mSFPnt2f     = osg.Pnt2f(ts,ts)
    self.mSFPnt3f     = osg.Pnt3f(ts,ts,ts)
    self.mSFPnt4f     = osg.Pnt4f(ts,ts,ts,ts)

    self.mSFVec2f     = osg.Vec2f(ts,ts)
    self.mSFVec2d     = osg.Vec2d(ts,ts)
    self.mSFVec3f     = osg.Vec3f(ts,ts,ts)
    self.mSFVec3d     = osg.Vec3d(ts,ts,ts)
    self.mSFVec4f     = osg.Vec4f(ts,ts,ts,ts)
    self.mSFVec4d     = osg.Vec4d(ts,ts,ts,ts)

    self.mSFMatrix    = osg.Matrix  (ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts)
    self.mSFMatrix4d  = osg.Matrix4d(ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts)

    self.mSFRotation  = osg.Quaternion(osg.Vec3f(ts,ts,ts), ts)

    self.mSFColor     = osg.Color3f(ts,ts,ts)
    self.mSFColorRGBA = osg.Color4f(ts,ts,ts,1)

    #self.mSFPlane     = osg.Plane(frameCount, frameCount+1, frameCount+2)
    self.mSFVolume    = osg.BoxVolume(osg.Vec3f(ts,ts,ts), osg.Vec3f(ts,ts,ts))

    self.mSFTime      = ts;

def changed(whichField, origin, details):
    pass
"

    priority 41
  }

  children
  [
        Node
        {
          core DEF TransCore1 ComponentTransform
          {
          }
      
          children
          [
            Node
            {
              core Inline
              {
	        url "../Models/tie.wrl"
              }
            }
          ]
        }

        Node
        {
          core DEF Reader PythonScript
          {    
            field SFInt32     mSFInt32     4
            field SFDouble    mSFDouble    2.2  
            field SFString    mSFString   "myString"
            field SFBool      mSFBool     True
    
            field SFPnt2f     mSFPnt2f     2.2 2.2
            field SFPnt3f     mSFPnt3f     3.3 3.3 3.3
            field SFPnt4f     mSFPnt4f     4.4 4.4 4.4 1

            field SFVec2f     mSFVec2f     2.2 2.2
            field SFVec2d     mSFVec2d     2.2 2.2
            field SFVec3f     mSFVec3f     3.3 3.3 3.3
            field SFVec3d     mSFVec3d     3.3 3.3 3.3
            field SFVec4f     mSFVec4f     4.4 4.4 4.4 1
            field SFVec4d     mSFVec4d     4.4 4.4 4.4 1  
  
            field SFRotation  mSFRotation  0 0 0 0

            field SFMatrix    mSFMatrix    1.1 2.1 3.1 4.1 5.1 6.1 7.1 8.1 9.1 10.1 11.1 12.1 13.1 14.1 15.1 16.1
            field SFMatrix4d  mSFMatrix4d  1.1 2.1 3.1 4.1 5.1 6.1 7.1 8.1 9.1 10.1 11.1 12.1 13.1 14.1 15.1 16.1

            field SFColor     mSFColor     0.1 0.1 0.1
            field SFColorRGBA mSFColorRGBA 0.4 0.4 0.4 1

            #field SFPlane     mSFPlane     ?
            field SFVolume     mSFVolume   0 0 0 1 1 1 1

            field SFTime       mSFTime     0.2

            script "
if(osg.getName(self)):
    self.name = osg.getName(self)
else:
    self.name = 'unknown'

def init():
    pass

def shutdown():
    pass

def frame(timeStamp, frameCount):
    print('Reader: mSFInt32  = ' + str(self.mSFInt32))
    print('Reader: mSFDouble = ' + str(self.mSFDouble))
    print('Reader: mSFString = ' + str(self.mSFString))
    print('Reader: mSFBool   = ' + str(self.mSFBool))

    print('Reader: mSFPnt2f = ' + str(self.mSFPnt2f))
    print('Reader: mSFPnt3f = ' + str(self.mSFPnt3f))
    print('Reader: mSFPnt4f = ' + str(self.mSFPnt4f))

    print('Reader: mSFVec2f = ' + str(self.mSFVec2f))
    print('Reader: mSFVec2d = ' + str(self.mSFVec2d))
    print('Reader: mSFVec3f = ' + str(self.mSFVec3f))
    print('Reader: mSFVec3d = ' + str(self.mSFVec3d))
    print('Reader: mSFVec4f = ' + str(self.mSFVec4f))
    print('Reader: mSFVec4d = ' + str(self.mSFVec4d))

    print('Reader: mSFMatrix   = ' + str(self.mSFMatrix))
    print('Reader: mSFMatrix4d = ' + str(self.mSFMatrix4d))

    print('Reader: mSFRotation = ' + str(self.mSFRotation))

    print('Reader: mSFColor = ' + str(self.mSFColor))
    print('Reader: mSFColorRGBA = ' + str(self.mSFColorRGBA))

    #print('Reader: mSFPlane  = ' + str(self.mSFPlane))
    print('Reader: mSFVolume.getMin() = ' + str(self.mSFVolume.getMin()))

    print ('Reader: mSFTime = ' + str(self.mSFTime))

def changed(whichField, origin, details):
    pass
"
            priority 42
          }

      children
      [
            Node
            {
              core DEF TransCore2 ComponentTransform
              {
              }

              children
              [
                Node
                {
                  core Inline
                  {
                    url "../Models/tie.wrl"
                  }
                }
              ]
            }
      ]
    }
  ]
}

ROUTE Writer.mSFInt32  TO Reader.mSFInt32
ROUTE Writer.mSFDouble TO Reader.mSFDouble
ROUTE Writer.mSFString TO Reader.mSFString
ROUTE Writer.mSFBool   TO Reader.mSFBool

ROUTE Writer.mSFPnt2f TO Reader.mSFPnt2f
ROUTE Writer.mSFPnt3f TO Reader.mSFPnt3f
ROUTE Writer.mSFPnt4f TO Reader.mSFPnt4f

ROUTE Writer.mSFVec2f TO Reader.mSFVec2f
ROUTE Writer.mSFVec2d TO Reader.mSFVec2d
ROUTE Writer.mSFVec3f TO Reader.mSFVec3f
ROUTE Writer.mSFVec3d TO Reader.mSFVec3d
ROUTE Writer.mSFVec4f TO Reader.mSFVec4f
ROUTE Writer.mSFVec4d TO Reader.mSFVec4d

ROUTE Writer.mSFMatrix    TO Reader.mSFMatrix
ROUTE Writer.mSFMatrix4d  TO Reader.mSFMatrix4d

ROUTE Writer.mSFRotation  TO Reader.mSFRotation

ROUTE Writer.mSFColor     TO Reader.mSFColor
ROUTE Writer.mSFColorRGBA TO Reader.mSFColorRGBA

#ROUTE Writer.mSFPlane TO Reader.mSFPlane
ROUTE Writer.mSFVolume TO Reader.mSFVolume

ROUTE Writer.mSFTime   TO Reader.mSFTime
